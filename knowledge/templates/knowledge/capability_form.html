{% extends "knowledge/base.html" %}

{% block title %}{% if object %}Edit{% else %}New{% endif %} Capability - {{ subdomain.name }}{% endblock %}

{% block sidebar_nav %}
{% include "knowledge/components/subdomain_nav.html" %}
{% endblock %}

{% block mobile_sidebar_nav %}
{% include "knowledge/components/subdomain_nav.html" %}
{% endblock %}

{% block breadcrumb_items %}
<li><a href="{% url 'knowledge:domain_list' product_id=product.pk %}">{{ product.name }}</a></li>
<li><a href="{% url 'knowledge:subdomain_list' product_id=product.pk domain_id=domain.pk %}">{{ domain.name }}</a></li>
<li><a href="{% url 'knowledge:capability_list' product_id=product.pk domain_id=domain.pk subdomain_id=subdomain.pk %}">{{ subdomain.name }}</a></li>
<li>{% if object %}Edit {{ object.name }}{% else %}New Capability{% endif %}</li>
{% endblock %}

{% block content %}
<div class="max-w-2xl">
    <h1 class="text-2xl font-bold mb-6">{% if object %}Edit Capability{% else %}New Capability{% endif %}</h1>

    <div class="bg-base-100 rounded-lg shadow p-6">
        <form method="post">
            {% csrf_token %}

            {% if form.errors %}
            <div class="alert alert-error mb-4">
                <i class="fa-solid fa-circle-exclamation"></i>
                <div>
                    <div class="font-bold">Please correct the errors below:</div>
                    <ul class="text-sm mt-1">
                        {% for field in form %}
                            {% for error in field.errors %}
                            <li>{{ field.label }}: {{ error }}</li>
                            {% endfor %}
                        {% endfor %}
                        {% for error in form.non_field_errors %}
                        <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
            {% endif %}

            <div class="form-control mb-4">
                <label class="label" for="id_name">
                    <span class="label-text font-medium">Name <span class="text-error">*</span></span>
                </label>
                <input type="text" name="name" id="id_name"
                       class="input input-bordered w-full {% if form.name.errors %}input-error{% endif %}"
                       value="{{ form.name.value|default:'' }}" required>
            </div>

            <div class="form-control mb-6">
                <label class="label" for="id_description">
                    <span class="label-text font-medium">Description</span>
                </label>
                <textarea name="description" id="id_description" rows="4"
                          class="textarea textarea-bordered w-full">{{ form.description.value|default:'' }}</textarea>
                <label class="label">
                    <span class="label-text-alt text-base-content/60">Optional description of this capability</span>
                </label>
            </div>

            <div class="flex gap-2 justify-end">
                <a href="{% url 'knowledge:capability_list' product_id=product.pk domain_id=domain.pk subdomain_id=subdomain.pk %}" class="btn btn-ghost">Cancel</a>
                <button type="submit" class="btn btn-primary">
                    <i class="fa-solid fa-check"></i>
                    {% if object %}Update{% else %}Create{% endif %} Capability
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
